(self.webpackChunkvisme_web=self.webpackChunkvisme_web||[]).push([[5292],{59770:(P,h,o)=>{var s=o(997201),r=o(383758);function c(d,a,n){var m=d==null?0:d.length;return m?(a=n||a===void 0?1:r(a),s(d,a<0?0:a,m)):[]}P.exports=c},745856:(P,h,o)=>{"use strict";o.r(h),o.d(h,{default:()=>O});var s=o(411855),r=o(55946),c=o(491530),d=o(72924),a=o(432563),n=o(833085);const m={container:"container--WzyguO5"};var S=o(333515);const p=l=>{let{object:i,child:e,thumbBase64:u}=l;const{appStore:g}=(0,c.g)(),v=(0,s.useRef)(null);return(0,S.A)(v,i.flipX,!1,g.settings.mode),s.createElement("img",{ref:v,alt:e.name,src:e.previewStaticURL||u||e.pose.previewUrl,height:i.height})},C=(0,r.PA)(p),T=l=>{let{object:i,child:e}=l;var u,g,v;const{appStore:f}=(0,c.g)(),E=f==null||(u=f.vismeObjectsStore)===null||u===void 0?void 0:u.characterEditorStore,[D,J]=(0,s.useState)(""),[y,I]=(0,s.useState)(!1),U=(g=f.settings)===null||g===void 0?void 0:g.isEditorMode,B=(v=f.settings)===null||v===void 0?void 0:v.isDocumentView,A=e.type===n.u.CHARACTER,t=e.isCharacterEdited&&i.isSelected&&E?E?.character:e.threeJsCharacter;return(0,s.useEffect)(()=>{if(!(!U&&!B||!e?.isAssetsLoaded&&A||!e?.cachedAssets&&A))if(A&&t){let R=!1;const L={useDefaultCamera:!0,backgroundTransparent:!0,camera:{position:[0,.83,2.5],rotation:[0,0,0]}};return a.f.generateVismeObjectImage({vismeObject:t,vismeObjectPoseUrl:e.modelUrl,sceneConfig:L,cachedAssets:e.cachedAssets,useRandomBackground:!1}).then(M=>{R||J(M)}).finally(()=>{R||I(!0)}),()=>{R=!0}}else I(!0)},[e?.poseUrl,e?.isAssetsLoaded,t?.style,t?.gender,t?.skinTone,t?.eyeColor,JSON.stringify(t?.characterAssetsColors),JSON.stringify(t?.assets)]),s.createElement("div",{className:m.container},y?s.createElement(C,{object:i,child:e,thumbBase64:D}):s.createElement(d.A,null))},j=(0,r.PA)(T),b=l=>{let{object:i}=l;return s.createElement(s.Fragment,null,i.allChildren.map(e=>s.createElement(j,{key:e.id,child:e,object:i})))},O=(0,r.PA)(b)},432563:(P,h,o)=>{"use strict";o.d(h,{f:()=>a});var s=o(59770),r=o.n(s),c=o(114317);const a=c.types.model("VismeObjectImageGeneratorStore").volatile(()=>({counter:0,generationQueue:[]})).views(()=>({get isDebug(){return window.location.hash==="#debugAvatar"}})).actions(n=>({shiftQueue(){n.generationQueue=r()(n.generationQueue)}})).actions(n=>({generateVismeObjectImage:(0,c.flow)(function*(m){let{vismeObject:S,vismeObjectPoseUrl:p,sceneConfig:C,cachedAssets:T,useRandomBackground:j=!0}=m,b=null,O=null;const l=new Promise((e,u)=>{b=e,O=u}),i={vismeObject:S,vismeObjectPoseUrl:p,useRandomBackground:j,sceneConfig:C,cachedAssets:T,resolvePromise:b,rejectPromise:O,queueOrder:n.counter};return n.counter++,n.generationQueue=[...n.generationQueue,i],yield l.finally(()=>{n.isDebug||n.shiftQueue()})})})).create()}}]);

//# sourceMappingURL=ThreeJsThumbnail.86fd97291d7a9a4c0c1f.chunk.js.map