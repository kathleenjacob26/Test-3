"use strict";(self.webpackChunkvisme_web=self.webpackChunkvisme_web||[]).push([[3093],{250445:(c,o,t)=>{t.d(o,{u:()=>n});const n=(l,h="https:")=>!l.startsWith("//")||window.location.protocol!=="file:"?l:`${h}${l}`},672781:(c,o,t)=>{t.d(o,{A:()=>a});var n=t(650405);const l=333,h=1;class i{videoId;id;el;endSeconds;startSeconds;thumbnail;additionalOptions;autoplay;looped;isPlayOnSetLoopedEnabled;muted;onEnd;onPause;onPlaying;onReady;onSeek;onMuteToggle;withControls;videoPlayer=null;isReady=!1;isFinished=!1;isFirstStart=!1;hasPlayedOnce=!1;_playingTimer=null;_willPlayOnReady=!1;constructor({el:e,id:d,videoId:p,muted:s=!1,looped:r=!1,isPlayOnSetLoopedEnabled:_=!0,autoplay:P=!1,withControls:m=!1,startSeconds:T=0,thumbnail:y=null,additionalOptions:f={},endSeconds:g=null,onEnd:v=()=>null,onReady:S=()=>null,onPlaying:E=()=>null,onSeek:I=()=>null,onPause:D=()=>null,onMuteToggle:b=()=>null}){this.el=e,this.id=d,this.videoId=p,this.muted=s,this.looped=r,this.isPlayOnSetLoopedEnabled=_,this.autoplay=P,this.withControls=m,this.startSeconds=T,this.endSeconds=g,this.onEnd=v,this.onReady=S,this.onPlaying=E,this.onPause=D,this.onMuteToggle=b,this.onSeek=I,this.thumbnail=y,this.additionalOptions=f,this.init().catch(this.handleError)}init(){return this.createPlayer()}async createPlayer(){await this._createPlayer(),this.isReady=!0,n.A.addToList(this),(this.autoplay||this._willPlayOnReady)&&this.play(),this.onReady(),this.isFirstStart=!0,this.hasPlayedOnce=!1}async handleStartTime(){await this.getCurrentTime()<this.startSeconds&&this.seekTo(this.startSeconds)}async handleEndTime(e=!1){const d=await this.getCurrentTime();!this.endSeconds||d<this.endSeconds||(this.isFinished=!0,this.looped||e?(this.seekTo(this.startSeconds),this.play()):(this.pause(),this.handleEnd()))}setStartSeconds(e=0){this.startSeconds!==e&&(this.startSeconds=e,this.handleStartTime().catch(this.handleError))}setEndSeconds(e=null){this.endSeconds!==e&&(this.endSeconds=e,this.handleEndTime().catch(this.handleError))}async _createPlayer(){}async getDuration(){return 0}play(){this.isReady?this._play():this._willPlayOnReady=!0}_play(){}pause(){}stop(){this.pause()}async isPlaying(){return this.isReady?this._isPlaying():!1}async _isPlaying(){return!1}async togglePlaying(){await this.isPlaying()?this.pause():this.play()}setLooped(e=!1){this.looped!==e&&(this.looped=e,this.looped&&this.isPlayOnSetLoopedEnabled&&this.play(),this._setLooped(e))}_setLooped(e){}mute(){}unMute(){}async isMuted(){return!1}_handleMute(e){this.onMuteToggle(e)}forceAbortBuffering(){}destroy(){n.A.removeFromList(this),this._playingTimer!==null&&clearInterval(this._playingTimer),this._destroy()}_destroy(){}seekTo(e){}async getCurrentTime(){return 0}_handleSeek(e){this.onSeek(e)}_handlePlaying(){this.onPlaying(),this.handleStartTime().catch(this.handleError),this.handleEndTime(!0).catch(this.handleError),this.checkIsFinished(),this.hasPlayedOnce||(this.hasPlayedOnce=!0),this._playingTimer||(this._playingTimer=setInterval(()=>{this.handleEndTime(!1).catch(this.handleError),this.checkIsFinished()},l))}_handlePause(){this.onPause(),this.isFirstStart&&(this.isFirstStart=!1),this._playingTimer!==null&&(clearInterval(this._playingTimer),this._playingTimer=null)}handleEnd(){this.isFinished=!0,this.looped?this.play():this.onEnd&&this.onEnd()}async checkIsFinished(){const e=await this.getDuration(),d=await this.getCurrentTime();e-d<h&&(this.isFinished=!0)}playbackRate(){return this._playbackRate()}_playbackRate(){return 1}handleError(e){console.error(e)}}const a=i},650405:(c,o,t)=>{t.d(o,{A:()=>h});var n=t(114317);const h=n.types.model({}).volatile(()=>({players:new Set})).actions(i=>({addToList(a){i.players.add(a)},removeFromList(a){i.players.delete(a)},pauseAllPlayersExcept(a){i.players.forEach(async u=>{u!==a&&u.pause()})}})).actions(i=>({pauseAllPlayers(){i.pauseAllPlayersExcept(null)}})).create()},259948:(c,o,t)=>{t.d(o,{default:()=>d});var n=t(812903),l=t(250445),h=t(859435),i=t(672781);const a=(0,l.u)("//www.youtube.com/iframe_api"),u=1;class e extends i.A{previousTime=this.startSeconds;progressIntervalID=null;pollingIntervalTime=100;isYoutubeMuted=!1;videoPlayer;async init(){await(0,h.k)(a),await(0,n.waitForVariable)("YT.Player"),await this.createPlayer(),this._pollPlayerState(),this.isYoutubeMuted=await this.isMuted(),this._pollPlayerState()}_createPlayer(){return new Promise(s=>{this.videoPlayer=new YT.Player(this.el.id,{playerVars:{enablejsapi:!0},events:{onReady:s,onStateChange:this._onPlayerStateChange}})})}_onPlayerStateChange=s=>{switch(s.data){case YT.PlayerState.PLAYING:this._handlePlaying();break;case YT.PlayerState.PAUSED:this._handlePause();break;case YT.PlayerState.ENDED:this.handleEnd();break;default:}};_pollPlayerState=()=>{this.progressIntervalID&&clearInterval(this.progressIntervalID),!(this.looped||!this.additionalOptions?.objectModelAutoplay)&&(this.progressIntervalID=setInterval(this._checkPlayerState,this.pollingIntervalTime))};_checkPlayerState=()=>{const s=2*this.pollingIntervalTime/1e3,r=this.videoPlayer.getCurrentTime(),_=this.playbackRate(),P=r-this.previousTime;Math.abs(P)>s*_&&(!this.endSeconds||r-this.startSeconds<this.endSeconds)&&(this.isFirstStart||this._handleSeek(r-this.startSeconds)),this.previousTime=r;const y=this.videoPlayer.isMuted();this.isYoutubeMuted!==y&&(this.isYoutubeMuted=y,this._handleMute(y))};async getDuration(){return this.videoPlayer.getDuration()}_play(){this.videoPlayer.playVideo()}get isLive(){return this.videoPlayer.playerInfo?.videoData?.isLive}pause(){this.videoPlayer.pauseVideo(),this._handlePause()}async _isPlaying(){return this.videoPlayer.getPlayerState()===u}mute(){this.videoPlayer.mute()}unMute(){this.videoPlayer.unMute()}async isMuted(){return this.videoPlayer.isMuted()}seekTo(s,r=!0){this.videoPlayer.seekTo(s,r)}async getCurrentTime(){return this.videoPlayer.getCurrentTime()}_destroy(){this.progressIntervalID&&(clearInterval(this.progressIntervalID),this.progressIntervalID=null),this.videoPlayer&&this.videoPlayer.destroy()}}const d=e}}]);

//# sourceMappingURL=youtubePlayer.b8a13f32121441977e84.chunk.js.map